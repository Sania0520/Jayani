<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>To Sansss 💖</title>
  <link rel="stylesheet" href="style.css"/>

  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    (function () {
      emailjs.init("LpQE7uVfrME92_7-7"); // 🔹 replace with your EmailJS Public Key
    })();
  </script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

  <style>
    .message-wrapper { display: flex; flex-direction: column; align-items: center; margin: 20px auto; max-width: 100%; padding: 0 10px; }
    .photocard { width: 350px; height: 420px; border-radius: 12px; object-fit: cover; box-shadow: 0 6px 12px rgba(0,0,0,0.3); transform: rotate(-2deg); transition: transform 0.3s ease; }
    .photocard:hover { transform: scale(1.05) rotate(0deg); }
    @media (max-width: 768px) { .photocard { width: 100px; height: 140px; } }
    .top-row { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 20px; }
    .message-row { display: flex; align-items: center; justify-content: center; flex-wrap: nowrap; width: 100%; max-width: 900px; }
    .side-images { display: flex; flex-direction: column; gap: 10px; margin: 0 10px; flex-shrink: 0; }
    form { flex: 1; max-width: 600px; margin: 0 30px; z-index: 2; }
    textarea { width: 500px; height: 120px; padding: 16px; border-radius: 12px; font-size: 1rem; border: 1px solid #ccc; resize: vertical; }
    button { margin-top: 12px; padding: 12px 24px; border-radius: 12px; background: #ff7aa2; color: #fff; border: 0; font-weight: bold; cursor: pointer; }
    @media (max-width: 768px) {
      .message-row { flex-wrap: wrap; }
      .side-images { flex-direction: row; margin: 10px 0; justify-content: center; width: 100%; }
    }
  </style>
</head>

<body class="pastel-bg">
  <h1>Messages to Sansss 💌</h1>

  <div class="message-wrapper">
    <div class="top-row" id="topImages"></div>
    <div class="message-row">
      <div class="side-images" id="leftImages"></div>
      <form id="messageForm">
        <textarea id="messageInput" rows="4" placeholder="Write something for her....."></textarea>
        <button type="submit">Send</button>
      </form>
      <div class="side-images" id="rightImages"></div>
    </div>
  </div>

  <p id="lyric" style="margin:20px 0; font-weight:600; text-align:center; font-family: 'Dancing Script', cursive;"></p>

  <audio id="songA" autoplay loop>
    <source src="music/circles.mp3" type="audio/mpeg"/>
  </audio>

  <div id="messages" style="max-width:520px; margin:0 auto; text-align:left;"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

    // 🔹 Firebase Config (replace with your project details)
    const firebaseConfig = {
      apiKey: "AIzaSyBPxG_8RjWWACYwk68N-Z7OE9FiA1UR5Uw",
      authDomain: "jayani-8adc3.firebaseapp.com",
      databaseURL: "https://jayani-8adc3-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "jayani-8adc3",
      storageBucket: "jayani-8adc3.firebasestorage.app",
      messagingSenderId: "617889508627",
      appId: "1:617889508627:web:24b538fbf1ae5660a7fee6",
      measurementId: "G-2K9G86MNZ0"

    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // === CONFIG FOR THIS PAGE ===
    const FRIEND_KEY = "Sanssss"; // 🔹 change for each friend
    const RECIPIENT_EMAIL = "saniajesline667@gmail.com"; // 🔹 friend's email
    const SERVICE_ID = "service_6bm5zo8"; // your EmailJS service ID
    const TEMPLATE_ID = "template_yblrgsm"; // your EmailJS template ID
    const FROM_NAME = "Jayani"; // sender name

    const messagesRef = ref(db, FRIEND_KEY);

    // Random lyric
    const lyrics = [
      "I only want to see you, no, I want to show you off to everyone, That I have someone like this in my life 🎶",
      "Looking at you, My precious Treasure 🌙",
      "I cry and laugh with you, This night where we offer all our love, How beautiful, Because you're my Headliner, my Headliner ~ 💫",
      "Don't hate yourself, you know it was a good choice, you were hurting so much that you couldn't even talk about it, Suffering alone , There's no way I didn't know, Because you're my breath, Don't be Sorry, It's just like a yawn that came because of shortage",
      "Through the voices of our hearts that we shared with each other, we pluck up our courage for that day, Let's all sing together 🎶, so that our loud singing would hide the sadness",
      "It will be okay, like the hands of a clock, It will find its place again after going in circles, La la la la La la la ~",
      "Remember that we're always together, I won't let go of your hand that never changes , La la la la la La la la ~ ",
      "Like the beginning, I hope all my times with you, Be wonderful and warm, As I yearn and yearn for that, I call for you, Compared to our beginning, Even if we become weary and sulky, Let's go back to when we considered each other precious(we will be), Like the beginning just like now ~",
      "For me who is out of breath, you're the only one, I want to continue seeing you even as we're facing each other, Hey even when there are no words, you are the only one who understands more ~",
      "Even today, I am on my way into you're arms, to you, who I'm thankful for and who will welcome me when i open the door, Within the whirlwind of a day, for giving me trivial happiness, for handling me all the smiles in this world into my two empty hands ~",
      "Even when I'm out of breath on a steep path, Even when I get lost on a cold day, (You) who holds out your hands with warmth, To you, to you , The story I want to tell you, To you, to you, I want to say it like this even more ~  ",
      "Although there are a lot of things that shine in this world, Amongst those, only you, only you are precious to me ~",
      "Perhaps, it may still be an imperfect love, But I want to create endless stories like those hidden inside an old book, Even when you come to me who may look worn out and falling apart on the outside, I 'll remain as a deep scent, Until I become the perfect/absolute love ~",
      "There hasn't been a single day where I wasn't sincere to you , we may not know but perhaps, it may still be an imperfect love ~",
      "Come to me if you're lost any time, when you share warm warmth the road comes back, we'll find it you don't have to be scared, at the end of this road there's warmth and a warm smile, they'll protect us in the fast-paced hours, let's slow down for a while, we'll see each other again.",
      "Until the day we sing together again, this road to you will not be over, for every reason and this length you're the one that's beautiful, at the end of this road after the turning point so that you don't get tired anymore I'll protect you, no matter what happens we'll see you again",
      "On a strange road, anyone can get lost, I'll be with you on the tough road, when you walk in the dark night don't do it yourself I'm here.",
      "My heart is overflowing with these cliché words, I haven't said them to you because I was worried they wouldn't sound sincere, rather than saying a simple /Thank you/, I've been searching for prettier words, so I haven't been able to thank you.",
      "Even if we don't know when our last will be, if by chance something happens and we aren't able to see each other, lean, lean, lean on me, lean, lean, lean on me.",
      "Oh girl, you're my answer, hold my hand when things are difficult, pats on your slumped shoulders, sometimes when you're tired from life and things are hard, come to me.",
      "I don't wanna let you go like this, I don't want to be scared with a broken heart, I'm the place you can come to, you're the place I can go to.",
      "When the second and minute hands overlap, the world holds its breath for a little while, zero o'clock, and you're gonna be happy.",
      "No matter how tough life gets, remember—you are my safe place, and I'll always be yours.",
      "You may not see how amazing you are, but I see it every single day."


    ];
    document.getElementById("lyric").innerText =
      lyrics[Math.floor(Math.random() * lyrics.length)];

    const form = document.getElementById("messageForm");
    const input = document.getElementById("messageInput");
    const messagesDiv = document.getElementById("messages");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const msg = input.value.trim();
      if (!msg) return;

      const entry = { text: msg, time: new Date().toLocaleString() };

      // 1️⃣ Save to Firebase
      push(messagesRef, entry);

      // 2️⃣ Send hidden email to the friend
      try {
        await emailjs.send(SERVICE_ID, TEMPLATE_ID, {
          to_email: RECIPIENT_EMAIL,
          name: FROM_NAME,
          message: msg,
          time: entry.time
        });
      } catch (err) {
        console.error("EmailJS error:", err);
      }

      input.value = "";
    });

    // Load messages from Firebase
    onChildAdded(messagesRef, (snapshot) => {
      const entry = snapshot.val();
      const p = document.createElement("p");
      p.style.background = "#fff0f6";
      p.style.padding = "10px";
      p.style.borderRadius = "10px";
      p.style.margin = "8px 0";
      p.textContent = `${entry.time} — ${entry.text}`;
      messagesDiv.appendChild(p);
    });

    // === Photocard display ===
        // === Photocard display ===
    const imageFolder = "images/san/";
    const imageCount = 33; // adjust to your folder count
    function getUniqueRandomImages(totalNeeded) {
      const all = Array.from({ length: imageCount }, (_, i) => `${imageFolder}san${i+1}.jpg`);
      for (let i = all.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [all[i], all[j]] = [all[j], all[i]];
      }
      return all.slice(0, totalNeeded);
    }
    function displayImages() {
      const top = document.getElementById("topImages");
      const left = document.getElementById("leftImages");
      const right = document.getElementById("rightImages");
      const chosen = getUniqueRandomImages(6);
      top.innerHTML = chosen.slice(0,2).map(src => `<img src="${src}" class="photocard"/>`).join("");
      left.innerHTML = chosen.slice(2,4).map(src => `<img src="${src}" class="photocard"/>`).join("");
      right.innerHTML = chosen.slice(4,6).map(src => `<img src="${src}" class="photocard"/>`).join("");
    }

    // Initial display
    displayImages();

    // 🔁 Auto cycle every 5 seconds
    setInterval(displayImages, 5000);

  </script>
</body>
</html>
